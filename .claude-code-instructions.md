# Claude Code Instructions: AppStack to Tailwind Conversion

## Project Overview

This is a Rails 8 playground app for converting AppStack Bootstrap 5 components to Tailwind CSS. The goal is to maintain visual fidelity while using modern Rails conventions (Hotwire/Stimulus + Tailwind).

## Critical Rules

### File Boundaries
1. **NEVER modify files in `vendor/appstack/`** - these are reference only
2. **ALWAYS create NEW files** in `app/views/components/` or `app/views/playground/`
3. **READ AppStack files** to understand structure, colors, and behavior
4. **WRITE Tailwind equivalents** in the Rails app

### AppStack File Structure Reference
```
vendor/appstack/
├── dist/
│   ├── css/app.css          # Compiled CSS (for color extraction)
│   ├── js/app.js            # Compiled JS (understand behavior)
│   ├── img/                 # Images
│   └── fonts/               # Fonts
├── src/
│   ├── scss/
│   │   ├── 1-variables/     # ⭐ COLOR DEFINITIONS HERE
│   │   ├── 2-mixins/        # Sass mixins
│   │   ├── 3-components/    # ⭐ COMPONENT STYLES HERE
│   │   ├── 4-utilities/     # Utilities/helpers
│   │   ├── 5-vendor/        # 3rd party styling
│   │   └── app.scss         # Main entry point
│   └── js/                  # JavaScript source
└── docs/                    # ⭐ HTML VISUAL REFERENCE
    ├── dashboard-default.html
    ├── ui-buttons.html
    ├── ui-cards.html
    └── ...
```

## Phase 1: Initial Setup & Color Extraction

### Task 1.1: Verify AppStack Files

**Check if AppStack files exist:**
```bash
# Verify structure
ls -la vendor/appstack/
ls -la vendor/appstack/dist/
ls -la vendor/appstack/src/scss/1-variables/
ls -la vendor/appstack/docs/
```

**If missing, prompt user:**
```
AppStack files not found in vendor/appstack/. 
Please extract your AppStack download and copy:
- dist/ folder
- src/ folder  
- docs/ folder
into vendor/appstack/
```

### Task 1.2: Extract Color Palette

**Step 1: Find SCSS color variables**
```bash
# Look for color definition files
cat vendor/appstack/src/scss/1-variables/_colors.scss
# OR
cat vendor/appstack/src/scss/1-variables/_variables.scss
# OR
cat vendor/appstack/src/scss/1-variables/_bootstrap-variables.scss
```

**Step 2: Parse and document colors**

Extract variables like:
- `$primary: #3b7ddd;`
- `$success: #28a745;`
- `$danger: #dc3545;`
- `$gray-100: #f8f9fa;`
- etc.

**Step 3: Update docs/COLORS.md**

Replace the `#____` placeholders with actual hex values found.

Format:
```markdown
## Theme Colors

| Name | Hex | SCSS Variable | Usage |
|------|-----|---------------|-------|
| Primary | `#3b7ddd` | `$primary` | Primary buttons, links |
| Success | `#28a745` | `$success` | Success messages |
...
```

**Step 4: Update config/tailwind.config.js**

Add the extracted colors to the Tailwind config:
```javascript
theme: {
  extend: {
    colors: {
      'appstack': {
        primary: '#3b7ddd',    // Use actual values from SCSS
        secondary: '#6c757d',
        success: '#28a745',
        info: '#17a2b8',
        warning: '#ffc107',
        danger: '#dc3545',
        light: '#f8f9fa',
        dark: '#212529',
      }
    }
  }
}
```

**Step 5: Create color test page**

Create `app/views/playground/colors.html.erb` to visually verify colors match AppStack.
```erb
<% content_for :page_title, "Color Palette Test" %>

<div class="space-y-8">
  <div>
    <h2 class="text-2xl font-bold mb-4">Theme Colors</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <% %w[primary secondary success info warning danger].each do |color| %>
        <div>
          <div class="h-24 rounded-lg bg-appstack-<%= color %> border border-gray-200"></div>
          <p class="mt-2 text-sm font-medium capitalize"><%= color %></p>
          <code class="text-xs text-gray-500">bg-appstack-<%= color %></code>
        </div>
      <% end %>
    </div>
  </div>
  
  <div>
    <h2 class="text-2xl font-bold mb-4">Comparison</h2>
    <p class="text-gray-600 mb-4">
      Open <code>vendor/appstack/docs/ui-buttons.html</code> in a browser
      and compare the button colors with the ones below.
    </p>
    <div class="flex flex-wrap gap-3">
      <button class="px-4 py-2 bg-appstack-primary text-white rounded hover:opacity-90">Primary</button>
      <button class="px-4 py-2 bg-appstack-success text-white rounded hover:opacity-90">Success</button>
      <button class="px-4 py-2 bg-appstack-warning text-white rounded hover:opacity-90">Warning</button>
      <button class="px-4 py-2 bg-appstack-danger text-white rounded hover:opacity-90">Danger</button>
    </div>
  </div>
</div>
```

**Verification:**
- Run `bin/rails server`
- Visit `http://localhost:3000/playground/colors`
- Compare with `vendor/appstack/docs/ui-buttons.html` in browser
- Colors should match visually

## Phase 2: Component Conversion Workflow

### General Process for Any Component

**Step 1: Identify the component**

User will specify a component (e.g., "sidebar", "buttons", "cards")

**Step 2: Find AppStack reference files**

For each component type, reference these files:

| Component | HTML Reference | SCSS Source |
|-----------|---------------|-------------|
| Sidebar | `docs/dashboard-default.html` | `src/scss/3-components/_sidebar.scss` |
| Buttons | `docs/ui-buttons.html` | `src/scss/3-components/_buttons.scss` |
| Cards | `docs/ui-cards.html` | `src/scss/3-components/_card.scss` |
| Forms | `docs/forms-basic.html` | `src/scss/3-components/_forms.scss` |
| Tables | `docs/tables-bootstrap.html` | `src/scss/3-components/_tables.scss` |
| Modals | `docs/ui-modals.html` | `src/scss/3-components/_modal.scss` |
| Navbar | `docs/dashboard-default.html` | `src/scss/3-components/_navbar.scss` |

**Step 3: Analyze AppStack implementation**
```bash
# View the HTML structure
cat vendor/appstack/docs/[component-file].html

# View the SCSS styles
cat vendor/appstack/src/scss/3-components/_[component].scss

# Understand the JavaScript behavior (if interactive)
cat vendor/appstack/src/js/modules/[component].js
# OR check compiled JS
grep -A 20 "[component]" vendor/appstack/dist/js/app.js
```

**Step 4: Create Tailwind component**

Create partial in `app/views/components/_[component].html.erb`

**Requirements:**
- Use Tailwind utility classes ONLY
- Match visual design exactly (colors, spacing, borders, shadows)
- Mobile-first responsive (use `sm:`, `md:`, `lg:` breakpoints)
- Use colors from `bg-appstack-*` or `text-appstack-*`

**Step 5: Add Stimulus controller (if interactive)**

If component has JavaScript behavior (modals, dropdowns, sidebar toggle):

Create `app/javascript/controllers/[component]_controller.js`
```javascript
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  static targets = ["..."]
  
  connect() {
    // Initialization
  }
  
  // Actions
}
```

**Step 6: Create demo page**

Create `app/views/playground/[component].html.erb`
```erb
<% content_for :page_title, "[Component Name]" %>

<div class="space-y-8">
  <div>
    <h2 class="text-xl font-semibold mb-4">[Variant Name]</h2>
    <%= render "components/[component]", ... %>
  </div>
  
  <!-- More variants -->
</div>

<div class="mt-12 p-4 bg-gray-100 rounded">
  <h3 class="font-semibold mb-2">Reference</h3>
  <p class="text-sm text-gray-600">
    Compare with: <code>vendor/appstack/docs/[reference-file].html</code>
  </p>
</div>
```

**Step 7: Update documentation**

Update `docs/COMPONENTS.md`:

Move the component from "To Do" to "Completed":
```markdown
## ✅ Completed
- [Component Name] - [Date completed]
  - Variants: [list variants]
  - Demo: `/playground/[component]`
  - Files: `app/views/components/_[component].html.erb`
```

**Step 8: Verify visual fidelity**

1. Run Rails server: `bin/rails server`
2. Open AppStack reference: `open vendor/appstack/docs/[reference].html`
3. Open your version: `http://localhost:3000/playground/[component]`
4. Compare side-by-side at multiple screen sizes:
   - Mobile: 375px
   - Tablet: 768px
   - Desktop: 1024px
   - Large: 1440px

## Phase 3: Specific Component Instructions

### Sidebar Navigation

**Reference files:**
- HTML: `vendor/appstack/docs/dashboard-default.html`
- SCSS: `vendor/appstack/src/scss/3-components/_sidebar.scss`

**Requirements:**
1. Fixed sidebar on desktop (lg: breakpoint)
2. Slide-out sidebar on mobile with backdrop
3. Active state highlighting for current page
4. Collapsible nav groups (if AppStack has them)
5. User profile section at bottom

**Key Tailwind patterns:**
- `hidden lg:flex` for desktop-only sidebar
- `translate-x-0` / `-translate-x-full` for mobile slide
- `transition-transform duration-300` for smooth animation
- `bg-appstack-[color]` for sidebar background

**Stimulus controller needs:**
- `toggle()` - open/close mobile sidebar
- `close()` - close mobile sidebar
- `handleEscape()` - close on ESC key
- Prevent body scroll when mobile sidebar open

### Buttons

**Reference files:**
- HTML: `vendor/appstack/docs/ui-buttons.html`
- SCSS: `vendor/appstack/src/scss/3-components/_buttons.scss`

**Variants to support:**
- Primary, secondary, success, info, warning, danger
- Outline variants
- Sizes: sm, md (default), lg
- Icon buttons
- Button groups
- Loading states (optional)

**Key Tailwind patterns:**
```erb
<!-- Primary button -->
class="px-4 py-2 bg-appstack-primary text-white rounded hover:opacity-90 
       focus:outline-none focus:ring-2 focus:ring-appstack-primary focus:ring-offset-2"

<!-- Outline button -->
class="px-4 py-2 border-2 border-appstack-primary text-appstack-primary rounded
       hover:bg-appstack-primary hover:text-white"

<!-- Small button -->
class="px-3 py-1.5 text-sm ..."

<!-- Large button -->
class="px-6 py-3 text-lg ..."
```

### Cards

**Reference files:**
- HTML: `vendor/appstack/docs/ui-cards.html`
- SCSS: `vendor/appstack/src/scss/3-components/_card.scss`

**Variants to support:**
- Basic card
- Card with header
- Card with footer
- Card with image
- Colored headers (using theme colors)

**Key Tailwind patterns:**
```erb
<!-- Basic card -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
  <div class="p-6">
    <h3 class="text-lg font-semibold mb-2">Card Title</h3>
    <p class="text-gray-600">Card content</p>
  </div>
</div>

<!-- Card with header -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
  <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
    <h3 class="text-lg font-semibold">Header</h3>
  </div>
  <div class="p-6">Content</div>
</div>
```

### Forms

**Reference files:**
- HTML: `vendor/appstack/docs/forms-basic.html`
- SCSS: `vendor/appstack/src/scss/3-components/_forms.scss`

**Elements to support:**
- Text inputs
- Textareas
- Select dropdowns
- Checkboxes
- Radio buttons
- Input groups (icon + input)
- Validation states (error, success)

**Key Tailwind patterns:**
```erb
<!-- Text input -->
<input type="text" 
       class="block w-full px-3 py-2 border border-gray-300 rounded-md
              focus:outline-none focus:ring-2 focus:ring-appstack-primary 
              focus:border-appstack-primary">

<!-- Input with error -->
<input type="text"
       class="block w-full px-3 py-2 border border-red-500 rounded-md
              focus:outline-none focus:ring-2 focus:ring-red-500">
<p class="mt-1 text-sm text-red-600">Error message</p>
```

### Tables

**Reference files:**
- HTML: `vendor/appstack/docs/tables-bootstrap.html`
- SCSS: `vendor/appstack/src/scss/3-components/_tables.scss`

**Variants to support:**
- Basic table
- Striped rows
- Hoverable rows
- Bordered table
- Compact table
- Responsive wrapper

**Key Tailwind patterns:**
```erb
<!-- Basic table -->
<div class="overflow-x-auto">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          Name
        </th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <tr class="hover:bg-gray-50">
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
          Data
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Striped rows -->
<tbody class="bg-white">
  <tr class="even:bg-gray-50">
    ...
  </tr>
</tbody>
```

### Modals

**Reference files:**
- HTML: `vendor/appstack/docs/ui-modals.html`
- SCSS: `vendor/appstack/src/scss/3-components/_modal.scss`

**Requirements:**
- Backdrop overlay
- Centered modal
- Close on backdrop click
- Close on ESC key
- Prevent body scroll when open
- Sizes: sm, md (default), lg, xl

**Stimulus controller pattern:**
```javascript
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  static targets = ["modal", "backdrop"]
  
  connect() {
    document.addEventListener("keydown", this.handleEscape.bind(this))
  }
  
  disconnect() {
    document.removeEventListener("keydown", this.handleEscape.bind(this))
  }
  
  open() {
    this.modalTarget.classList.remove("hidden")
    this.backdropTarget.classList.remove("hidden")
    document.body.classList.add("overflow-hidden")
  }
  
  close() {
    this.modalTarget.classList.add("hidden")
    this.backdropTarget.classList.add("hidden")
    document.body.classList.remove("overflow-hidden")
  }
  
  handleEscape(event) {
    if (event.key === "Escape") {
      this.close()
    }
  }
  
  backdropClick(event) {
    if (event.target === this.backdropTarget) {
      this.close()
    }
  }
}
```

## Common Patterns & Best Practices

### Responsive Design

Always use mobile-first approach:
```erb
<!-- Mobile: stack vertically, Desktop: horizontal -->
<div class="flex flex-col lg:flex-row gap-4">
  ...
</div>

<!-- Mobile: full width, Desktop: fixed sidebar -->
<div class="w-full lg:w-64">
  ...
</div>

<!-- Hide on mobile, show on desktop -->
<div class="hidden lg:block">
  ...
</div>

<!-- Show on mobile, hide on desktop -->
<div class="lg:hidden">
  ...
</div>
```

### Color Usage

Always use the extracted AppStack colors:
```erb
<!-- Background colors -->
bg-appstack-primary
bg-appstack-success
bg-appstack-danger

<!-- Text colors -->
text-appstack-primary
text-appstack-success

<!-- Border colors -->
border-appstack-primary

<!-- With opacity -->
bg-appstack-primary/90
bg-appstack-primary/50
```

### Spacing & Sizing

Match AppStack's spacing:
```erb
<!-- Common spacings -->
p-4      <!-- padding: 1rem -->
p-6      <!-- padding: 1.5rem -->
px-4 py-2  <!-- horizontal/vertical -->
gap-4    <!-- gap: 1rem -->
space-y-4  <!-- vertical spacing between children -->

<!-- Rounded corners -->
rounded     <!-- 0.25rem -->
rounded-lg  <!-- 0.5rem -->
rounded-full  <!-- pill shape -->
```

### Shadows & Borders
```erb
<!-- Shadows -->
shadow-sm    <!-- subtle shadow -->
shadow       <!-- standard shadow -->
shadow-lg    <!-- larger shadow -->

<!-- Borders -->
border             <!-- 1px border -->
border-2           <!-- 2px border -->
border-gray-200    <!-- border color -->
```

### Interactive States
```erb
<!-- Hover -->
hover:bg-gray-50
hover:text-appstack-primary
hover:opacity-90

<!-- Focus -->
focus:outline-none
focus:ring-2
focus:ring-appstack-primary
focus:ring-offset-2

<!-- Active -->
active:bg-gray-100

<!-- Disabled -->
disabled:opacity-50
disabled:cursor-not-allowed
```

## Testing & Verification Checklist

For each component, verify:

- [ ] Colors match AppStack exactly
- [ ] Spacing/sizing matches AppStack
- [ ] Responsive at all breakpoints (375px, 768px, 1024px, 1440px)
- [ ] Hover states work
- [ ] Focus states work (keyboard navigation)
- [ ] Interactive behavior works (Stimulus controllers)
- [ ] Accessible (proper ARIA labels, keyboard support)
- [ ] Demo page created in `/playground`
- [ ] Component partial created in `/components`
- [ ] Documentation updated in `docs/COMPONENTS.md`
- [ ] Visual comparison screenshot taken (optional)

## Error Handling

### If AppStack files are missing:
```
Error: vendor/appstack/ directory not found or incomplete.

Please extract your AppStack download and ensure the following
structure exists:

vendor/appstack/
├── dist/
│   ├── css/app.css
│   └── js/app.js
├── src/
│   └── scss/
│       └── 1-variables/
└── docs/
    └── *.html

Then re-run this command.
```

### If colors can't be extracted:
```
Warning: Could not find color definitions in SCSS variables.

Attempting to extract from compiled CSS...
[run extraction from dist/css/app.css]

If colors still can't be found, please:
1. Open vendor/appstack/docs/ui-buttons.html in a browser
2. Use DevTools to inspect button background colors
3. Manually update docs/COLORS.md with hex values
4. Update config/tailwind.config.js
```

### If visual comparison fails:
```
The Tailwind version doesn't match AppStack visually.

Troubleshooting:
1. Compare side-by-side in browser
2. Check if colors are correctly defined in tailwind.config.js
3. Inspect element with DevTools to compare computed styles
4. Check AppStack SCSS source for any custom spacing/sizing
5. Verify responsive breakpoints match (lg: = 1024px in both)
```

## Output Format

When completing a task, provide:

1. **Summary** of what was done
2. **Files created/modified** with paths
3. **Next steps** (if applicable)
4. **Verification instructions** for the user

Example:
```
✅ Completed: Color Palette Extraction

Files Modified:
- docs/COLORS.md (added 8 theme colors + gray scale)
- config/tailwind.config.js (added appstack color definitions)

Files Created:
- app/views/playground/colors.html.erb (color test page)

Next Steps:
1. Run: bin/rails server
2. Visit: http://localhost:3000/playground/colors
3. Compare colors with vendor/appstack/docs/ui-buttons.html
4. If colors match, we can proceed to sidebar navigation

Verification:
Open both pages side-by-side and verify the primary, success,
warning, and danger button colors match exactly.
```

## Priority Order for Conversion

Recommend this order:

1. ✅ Color palette extraction (foundation)
2. Sidebar navigation (most complex layout piece)
3. Buttons (most frequently used)
4. Forms (common user interaction)
5. Cards (common layout component)
6. Tables (data display)
7. Modals (overlays)
8. Remaining components as needed

## User Communication

- Be explicit about what you're reading vs. creating
- Always reference AppStack file paths when analyzing
- Explain Tailwind choices (why specific classes were used)
- Point out any visual differences from AppStack
- Suggest improvements while maintaining fidelity

## Success Criteria

A component conversion is successful when:

1. Visual appearance matches AppStack at all breakpoints
2. Interactive behavior matches (if applicable)
3. Code is clean, readable, and uses Tailwind conventions
4. Documentation is updated
5. Demo page works and is accessible
6. No custom CSS required (pure Tailwind utilities)